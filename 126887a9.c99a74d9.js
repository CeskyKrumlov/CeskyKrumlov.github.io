(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{502:function(e,n,a){"use strict";a.d(n,"a",(function(){return u})),a.d(n,"b",(function(){return m}));var t=a(0),l=a.n(t);function r(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}function c(e,n){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),a.push.apply(a,t)}return a}function o(e){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?c(Object(a),!0).forEach((function(n){r(e,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(a,n))}))}return e}function i(e,n){if(null==e)return{};var a,t,l=function(e,n){if(null==e)return{};var a,t,l={},r=Object.keys(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||(l[a]=e[a]);return l}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)a=r[t],n.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var b=l.a.createContext({}),p=function(e){var n=l.a.useContext(b),a=n;return e&&(a="function"==typeof e?e(n):o(o({},n),e)),a},u=function(e){var n=p(e.components);return l.a.createElement(b.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return l.a.createElement(l.a.Fragment,{},n)}},s=l.a.forwardRef((function(e,n){var a=e.components,t=e.mdxType,r=e.originalType,c=e.parentName,b=i(e,["components","mdxType","originalType","parentName"]),u=p(a),s=t,m=u["".concat(c,".").concat(s)]||u[s]||d[s]||r;return a?l.a.createElement(m,o(o({ref:n},b),{},{components:a})):l.a.createElement(m,o({ref:n},b))}));function m(e,n){var a=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var r=a.length,c=new Array(r);c[0]=s;var o={};for(var i in n)hasOwnProperty.call(n,i)&&(o[i]=n[i]);o.originalType=e,o.mdxType="string"==typeof e?e:t,c[1]=o;for(var b=2;b<r;b++)c[b]=a[b];return l.a.createElement.apply(null,c)}return l.a.createElement.apply(null,a)}s.displayName="MDXCreateElement"},503:function(e,n,a){"use strict";function t(e){var n,a,l="";if("string"==typeof e||"number"==typeof e)l+=e;else if("object"==typeof e)if(Array.isArray(e))for(n=0;n<e.length;n++)e[n]&&(a=t(e[n]))&&(l&&(l+=" "),l+=a);else for(n in e)e[n]&&(l&&(l+=" "),l+=n);return l}n.a=function(){for(var e,n,a=0,l="";a<arguments.length;)(e=arguments[a++])&&(n=t(e))&&(l&&(l+=" "),l+=n);return l}},504:function(e,n,a){"use strict";var t=a(0);const l=Object(t.createContext)(void 0);n.a=l},505:function(e,n,a){"use strict";var t=a(0),l=a(504);n.a=function(){const e=Object(t.useContext)(l.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},506:function(e,n,a){"use strict";var t=a(0),l=a.n(t),r=a(505),c=a(503),o=a(47),i=a.n(o);const b=37,p=39;n.a=function(e){const{block:n,children:a,defaultValue:o,values:u,groupId:d}=e,{tabGroupChoices:s,setTabGroupChoices:m}=Object(r.a)(),[g,O]=Object(t.useState)(o),[j,f]=Object(t.useState)(!1);if(null!=d){const e=s[d];null!=e&&e!==g&&u.some(n=>n.value===e)&&O(e)}const y=e=>{O(e),null!=d&&m(d,e)},k=[],N=e=>{e.metaKey||e.altKey||e.ctrlKey||f(!0)},v=()=>{f(!1)};return Object(t.useEffect)(()=>{window.addEventListener("keydown",N),window.addEventListener("mousedown",v)},[]),l.a.createElement("div",null,l.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(c.a)("tabs",{"tabs--block":n})},u.map(({value:e,label:n})=>l.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":g===e,className:Object(c.a)("tabs__item",i.a.tabItem,{"tabs__item--active":g===e}),style:j?{}:{outline:"none"},key:e,ref:e=>k.push(e),onKeyDown:e=>{((e,n,a)=>{switch(a.keyCode){case p:((e,n)=>{const a=e.indexOf(n)+1;e[a]?e[a].focus():e[0].focus()})(e,n);break;case b:((e,n)=>{const a=e.indexOf(n)-1;e[a]?e[a].focus():e[e.length-1].focus()})(e,n)}})(k,e.target,e),N(e)},onFocus:()=>y(e),onClick:()=>{y(e),f(!1)},onPointerDown:()=>f(!1)},n))),l.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},t.Children.toArray(a).filter(e=>e.props.value===g)[0]))}},507:function(e,n,a){"use strict";var t=a(0),l=a.n(t);n.a=function(e){return l.a.createElement("div",null,e.children)}},596:function(e,n,a){"use strict";a.r(n),n.default=a.p+"assets/images/24-c3910c8a426e6f1b14f1d0d331652a41.png"},98:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return i})),a.d(n,"metadata",(function(){return b})),a.d(n,"rightToc",(function(){return p})),a.d(n,"default",(function(){return d}));var t=a(2),l=a(6),r=(a(0),a(502)),c=a(506),o=a(507),i={id:"8.sentinelBreaker",title:"Sentinel \u670d\u52a1\u7194\u65ad",hide_title:!0},b={unversionedId:"springcloudalibaba/\u6d41\u91cf\u536b\u5175/8.sentinelBreaker",id:"springcloudalibaba/\u6d41\u91cf\u536b\u5175/8.sentinelBreaker",isDocsHomePage:!1,title:"Sentinel \u670d\u52a1\u7194\u65ad",description:"Sentinel \u670d\u52a1\u7194\u65ad",source:"@site/docs/springcloudalibaba/\u6d41\u91cf\u536b\u5175/8.\u670d\u52a1\u7194\u65ad.md",slug:"/springcloudalibaba/\u6d41\u91cf\u536b\u5175/8.sentinelBreaker",permalink:"/docs/springcloudalibaba/\u6d41\u91cf\u536b\u5175/8.sentinelBreaker",version:"current",sidebar:"someSidebar",previous:{title:"SentinelResource \u6ce8\u89e3",permalink:"/docs/springcloudalibaba/\u6d41\u91cf\u536b\u5175/7.sentinelResource"},next:{title:"Sentinel \u89c4\u5219\u6301\u4e45\u5316",permalink:"/docs/springcloudalibaba/\u6d41\u91cf\u536b\u5175/9.sentinelPersistence"}},p=[{value:"Sentinel \u670d\u52a1\u7194\u65ad",id:"sentinel-\u670d\u52a1\u7194\u65ad",children:[]},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",children:[{value:"Cloudalibaba-provider-payment9003",id:"cloudalibaba-provider-payment9003",children:[]},{value:"Cloudalibaba-provider-payment9004",id:"cloudalibaba-provider-payment9004",children:[]},{value:"Cloudalibaba-consumer-nacos-order84",id:"cloudalibaba-consumer-nacos-order84",children:[]}]},{value:"\u670d\u52a1\u7194\u65ad\u65e0\u914d\u7f6e",id:"\u670d\u52a1\u7194\u65ad\u65e0\u914d\u7f6e",children:[]},{value:"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e fallback",id:"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e-fallback",children:[]},{value:"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e blockHandler",id:"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e-blockhandler",children:[]},{value:"\u670d\u52a1\u7194\u65ad\u4e24\u4e2a\u90fd\u914d",id:"\u670d\u52a1\u7194\u65ad\u4e24\u4e2a\u90fd\u914d",children:[]},{value:"\u5f02\u5e38\u5ffd\u7565",id:"\u5f02\u5e38\u5ffd\u7565",children:[]},{value:"\u6574\u5408 OpenFeign",id:"\u6574\u5408-openfeign",children:[]}],u={rightToc:p};function d(e){var n=e.components,i=Object(l.a)(e,["components"]);return Object(r.b)("wrapper",Object(t.a)({},u,i,{components:n,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"sentinel-\u670d\u52a1\u7194\u65ad"},"Sentinel \u670d\u52a1\u7194\u65ad"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("strong",{parentName:"p"},"Sentinel \u6574\u5408 ",Object(r.b)("inlineCode",{parentName:"strong"},"Ribbon"),"\u3001",Object(r.b)("inlineCode",{parentName:"strong"},"OpenFeign")))),Object(r.b)("h1",{id:"\u73af\u5883\u51c6\u5907"},"\u73af\u5883\u51c6\u5907"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},"\u51c6\u5907\u2014\u2014\u65b0\u5efa\u4e00\u4e9b\u6a21\u5757"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u4e24\u4e2a\u670d\u52a1\u63d0\u4f9b\u8005 ",Object(r.b)("inlineCode",{parentName:"li"},"provider-payment9003"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"9004")),Object(r.b)("li",{parentName:"ul"},"\u4e00\u4e2a\u670d\u52a1\u6d88\u8d39\u8005 ",Object(r.b)("inlineCode",{parentName:"li"},"consumer-order84")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"84")," \u901a\u8fc7 ",Object(r.b)("inlineCode",{parentName:"li"},"Nacos")," \u627e\u5230 ",Object(r.b)("inlineCode",{parentName:"li"},"9003"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"9004")," \u7684\u771f\u5b9e\u5730\u5740\uff0c\u901a\u8fc7 ",Object(r.b)("inlineCode",{parentName:"li"},"Ribbon")," \u8d1f\u8f7d\u5747\u8861\u7684\u8fdb\u884c\u8bbf\u95ee"))),Object(r.b)("h2",{id:"cloudalibaba-provider-payment9003"},"Cloudalibaba-provider-payment9003"),Object(r.b)(c.a,{defaultValue:"1",values:[{label:"POM",value:"1"},{label:"YAML",value:"2"},{label:"\u4e3b\u542f\u52a8",value:"3"},{label:"\u4e1a\u52a1\u7c7b",value:"4"}],mdxType:"Tabs"},Object(r.b)(o.a,{value:"1",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),"<dependencies>\n \x3c!-- SpringCloud ailibaba nacos--\x3e\n <dependency>\n     <groupId>com.alibaba.cloud</groupId>\n     <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>\n </dependency>\n \x3c!-- SpringCloud ailibaba sentinel--\x3e\n <dependency>\n     <groupId>com.alibaba.cloud</groupId>\n     <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>\n </dependency>\n <dependency>\x3c!-- \u5f15\u7528\u81ea\u5df1\u5b9a\u4e49\u7684api\u901a\u7528\u5305\uff0c\u53ef\u4ee5\u4f7f\u7528Payment\u652f\u4ed8Entity --\x3e\n     <groupId>org.example</groupId>\n     <artifactId>cloud-api-commons</artifactId>\n     <version>1.0-SNAPSHOT</version>\n </dependency>\n <dependency>\n     <groupId>org.springframework.cloud</groupId>\n     <artifactId>spring-cloud-starter-openfeign</artifactId>\n </dependency>\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-web</artifactId>\n </dependency>\n \x3c!--\u76d1\u63a7--\x3e\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-actuator</artifactId>\n </dependency>\n \x3c!--\u70ed\u90e8\u7f72--\x3e\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-devtools</artifactId>\n     <scope>runtime</scope>\n     <optional>true</optional>\n </dependency>\n <dependency>\n     <groupId>org.projectlombok</groupId>\n     <artifactId>lombok</artifactId>\n     <optional>true</optional>\n </dependency>\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-test</artifactId>\n     <scope>test</scope>\n </dependency>\n</dependencies>\n"))),Object(r.b)(o.a,{value:"2",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-yaml"}),"server:\nport: 9003\n\nspring:\napplication:\n name: nacos-payment-provider\ncloud:\n nacos:\n   discovery:\n     server-addr: localhost:8848\n\nmanagement:\nendpoints:\n web:\n   exposure:\n     include: '*'\n"))),Object(r.b)(o.a,{value:"3",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),"@SpringBootApplication\n@EnableDiscoveryClient\npublic class PaymentMain9003 {\n\n public static void main(String[] args) {\n     SpringApplication.run(PaymentMain9003.class, args);\n }\n}\n"))),Object(r.b)(o.a,{value:"4",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RestController\npublic class PaymentController {\n\n @Value("${server.port}")\n private String serverPort;\n\n public static HashMap<Long, Payment> map = new HashMap<>();\n\n static { // \u6a21\u62df\u6570\u636e\u5e93\n     map.put(1L, new Payment(1L, "1111"));\n     map.put(2L, new Payment(2L, "2222"));\n     map.put(3L, new Payment(3L, "3333"));\n }\n\n\n @GetMapping(value = "/paymentSQL/{id}")\n public CommonResult<Payment> paymentSQL(@PathVariable("id") Long id) {\n     Payment payment = map.get(id);\n     CommonResult<Payment> result = new CommonResult<>(200, "from mysql,serverPort: " + serverPort, payment);\n     return result;\n }\n}\n')))),Object(r.b)("h2",{id:"cloudalibaba-provider-payment9004"},"Cloudalibaba-provider-payment9004"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"\u7167\u7740 9003 \u5f04\u4e00\u4e2a\uff0c\u6539\u4e00\u4e0b\u7aef\u53e3\u53f7"))),Object(r.b)("h2",{id:"cloudalibaba-consumer-nacos-order84"},"Cloudalibaba-consumer-nacos-order84"),Object(r.b)(c.a,{defaultValue:"1",values:[{label:"POM",value:"1"},{label:"YAML",value:"2"},{label:"\u4e3b\u542f\u52a8",value:"3"},{label:"\u4e1a\u52a1\u7c7b",value:"4"}],mdxType:"Tabs"},Object(r.b)(o.a,{value:"1",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),"<dependencies>\n \x3c!-- SpringCloud ailibaba nacos--\x3e\n <dependency>\n     <groupId>com.alibaba.cloud</groupId>\n     <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>\n </dependency>\n \x3c!-- SpringCloud ailibaba sentinel--\x3e\n <dependency>\n     <groupId>com.alibaba.cloud</groupId>\n     <artifactId>spring-cloud-starter-alibaba-sentinel</artifactId>\n </dependency>\n <dependency>\x3c!-- \u5f15\u7528\u81ea\u5df1\u5b9a\u4e49\u7684api\u901a\u7528\u5305\uff0c\u53ef\u4ee5\u4f7f\u7528Payment\u652f\u4ed8Entity --\x3e\n     <groupId>org.example</groupId>\n     <artifactId>cloud-api-commons</artifactId>\n     <version>1.0-SNAPSHOT</version>\n </dependency>\n <dependency>\n     <groupId>org.springframework.cloud</groupId>\n     <artifactId>spring-cloud-starter-openfeign</artifactId>\n </dependency>\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-web</artifactId>\n </dependency>\n \x3c!--\u76d1\u63a7--\x3e\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-actuator</artifactId>\n </dependency>\n \x3c!--\u70ed\u90e8\u7f72--\x3e\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-devtools</artifactId>\n     <scope>runtime</scope>\n     <optional>true</optional>\n </dependency>\n <dependency>\n     <groupId>org.projectlombok</groupId>\n     <artifactId>lombok</artifactId>\n     <optional>true</optional>\n </dependency>\n <dependency>\n     <groupId>org.springframework.boot</groupId>\n     <artifactId>spring-boot-starter-test</artifactId>\n     <scope>test</scope>\n </dependency>\n</dependencies>\n"))),Object(r.b)(o.a,{value:"2",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-yaml"}),"server:\nport: 84\n\nspring:\napplication:\n name: nacos-order-consumer\ncloud:\n nacos:\n   discovery:\n     server-addr: localhost:8848\n sentinel:\n   transport:\n     dashboard: localhost:8080\n     port: 8719\n\n#\u6d88\u8d39\u8005\u5c06\u53bb\u8bbf\u95ee\u7684\u5fae\u670d\u52a1\u540d\u79f0\nserver-url:\nnacos-user-service: http://nacos-payment-provider\n\n#\u6fc0\u6d3bSentinel\u5bf9Feign\u7684\u652f\u6301\n#feign:\n#  sentinel:\n#    enabled: true\n"))),Object(r.b)(o.a,{value:"3",mdxType:"TabItem"},Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),"@SpringBootApplication\n@EnableDiscoveryClient\n//@EnableFeignClients\npublic class SentinelOrderMain84 {\n\n public static void main(String[] args) {\n     SpringApplication.run(SentinelOrderMain84.class,args);\n }\n}\n"))),Object(r.b)(o.a,{value:"4",mdxType:"TabItem"},Object(r.b)("blockquote",null,Object(r.b)("h3",Object(t.a)({parentName:"blockquote"},{id:"applicationcontextconfig"}),"ApplicationContextConfig"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u914d\u7f6e\u4e00\u4e2a ",Object(r.b)("inlineCode",{parentName:"li"},"RestTemplate")," \u7684 bean")),Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),"@Configuration\npublic class ApplicationContextConfig {\n\n    @Bean\n    @LoadBalanced // ribbon LB\n    public RestTemplate getRestTemplate() {\n        return new RestTemplate();\n    }\n}\n")),Object(r.b)("h3",Object(t.a)({parentName:"blockquote"},{id:"circlebreakercontroller"}),"CircleBreakerController"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u8fdc\u7a0b\u5fae\u670d\u52a1\u8c03\u7528")),Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RestController\n@Slf4j\npublic class CircleBreakerController {\n    // to 9003/9004, get from nacos \n    public static final String SERVICE_URL = "http://nacos-payment-provider";\n\n    @Resource\n    private RestTemplate restTemplate;\n\n    @RequestMapping("/consumer/fallback/{id}")\n    @SentinelResource(value = "fallback")\n    // @SentinelResource(value = "fallback",fallback ="handlerFallback")\n    // \u5f02\u5e38\u5ffd\u7565 exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38\n    // @SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler")\n    public CommonResult<Payment> fallback(@PathVariable Long id) {\n        CommonResult<Payment> result = restTemplate.getForObject(SERVICE_URL + "/paymentSQL/" + id, CommonResult.class, id);\n\n        if (id == 4) {\n            throw new IllegalArgumentException("IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...");\n        } else if (result.getData() == null) {\n            throw new NullPointerException("NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38");\n        }\n\n        return result;\n    }\n\n\n    public CommonResult handlerFallback(@PathVariable Long id, Throwable e) {\n        Payment payment = new Payment(id, "null");\n        return new CommonResult(444, "\u5f02\u5e38handlerFallback\uff0cexception\u5185\u5bb9\uff1a " + e.getMessage(), payment);\n    }\n\n\n    public CommonResult blockHandler(@PathVariable Long id, BlockException e) {\n        Payment payment = new Payment(id, "null");\n        return new CommonResult(444, "blockHandler-sentinel \u9650\u6d41\uff0cBlockException\uff1a " + e.getMessage(), payment);\n    }\n\n    //======= OpenFeign\n    /*@Resource\n    private PaymentService paymentService;\n\n    @GetMapping(value = "/consumer/paymentSQL/{id}")\n    public CommonResult<Payment> paymentSQL(@PathVariable("id") Long id) {\n        return paymentService.paymentSQL(id);\n    }*/\n}\n'))))),Object(r.b)("br",null),Object(r.b)("h1",{id:"\u670d\u52a1\u7194\u65ad\u65e0\u914d\u7f6e"},"\u670d\u52a1\u7194\u65ad\u65e0\u914d\u7f6e"),Object(r.b)("blockquote",null,Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u91cd\u542f ",Object(r.b)("inlineCode",{parentName:"li"},"9003"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"9004")),Object(r.b)("li",{parentName:"ul"},"\u542f\u52a8 ",Object(r.b)("inlineCode",{parentName:"li"},"84")),Object(r.b)("li",{parentName:"ul"},"\u8bbf\u95ee ",Object(r.b)("inlineCode",{parentName:"li"},"http://localhost:84/consumer/fallback/1"),"\uff0c\u5f97\u5230\u6b63\u5e38\u54cd\u5e94\uff0c\u4e14\u53ef\u4ee5\u770b\u5230 ",Object(r.b)("inlineCode",{parentName:"li"},"9003"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"9004")," \u4e24\u4e2a\u8282\u70b9\u5728\u8f6e\u8be2\u8d1f\u8f7d\u5747\u8861"))),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\u518d\u770b ",Object(r.b)("inlineCode",{parentName:"li"},"order84")," Controller \u4e2d\u7684\u4e1a\u52a1\u4ee3\u7801",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"\u5f53 ",Object(r.b)("inlineCode",{parentName:"li"},"id")," \u4e3a ",Object(r.b)("inlineCode",{parentName:"li"},"1"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"2"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"3")," \u65f6\uff0c\u80fd\u5230 ",Object(r.b)("inlineCode",{parentName:"li"},"9003"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"9004")," \u67e5\u5230\u6570\u636e\u6b63\u5e38\u8fd4\u56de"),Object(r.b)("li",{parentName:"ul"},"\u5f53\u4e3a ",Object(r.b)("inlineCode",{parentName:"li"},"4")," \u629b\u51fa\u4e00\u4e2a ",Object(r.b)("inlineCode",{parentName:"li"},"\u975e\u6cd5\u53c2\u6570\u5f02\u5e38")),Object(r.b)("li",{parentName:"ul"},"\u5982\u679c\u662f ",Object(r.b)("inlineCode",{parentName:"li"},"1\u30012\u30013\u30014")," \u4ee5\u5916\u7684\u6570\u5b57\uff0c\u4f1a\u8dd1\u53bb ",Object(r.b)("inlineCode",{parentName:"li"},"9003"),"\u3001",Object(r.b)("inlineCode",{parentName:"li"},"9004")," \u67e5\uff0c\u7136\u540e\u5565\u4e5f\u67e5\u4e0d\u5230\uff0c\u5f97\u5230\u7684\u54cd\u5e94\u4e2d ",Object(r.b)("inlineCode",{parentName:"li"},"data")," \u4e3a\u7a7a\uff0c\u4e8e\u662f ",Object(r.b)("inlineCode",{parentName:"li"},"84")," \u81ea\u5df1\u629b\u51fa\u4e00\u4e2a ",Object(r.b)("inlineCode",{parentName:"li"},"\u7a7a\u6307\u9488\u5f02\u5e38")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"\u4e0a\u8ff0\u4e24\u4e2a\u5f02\u5e38\u90fd\u662f Java \u5c42\u9762\u7684\uff0c\u540e\u7eed\u5c31\u662f\u6f14\u793a\u7528 ",Object(r.b)("inlineCode",{parentName:"strong"},"fallback")," \u5c5e\u6027\u6765\u5904\u7406\u5b83\u4eec"))))),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RequestMapping("/consumer/fallback/{id}")\n@SentinelResource(value = "fallback")\n// @SentinelResource(value = "fallback",fallback ="handlerFallback")\n// \u5f02\u5e38\u5ffd\u7565 exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38\n// @SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler")\npublic CommonResult<Payment> fallback(@PathVariable Long id) {\n  CommonResult<Payment> result = restTemplate.getForObject(SERVICE_URL + "/paymentSQL/" + id, CommonResult.class, id);\n\n    if (id == 4) {\n      throw new IllegalArgumentException("IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...");\n    } else if (result.getData() == null) {\n      throw new NullPointerException("NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38");\n    }\n\n    return result;\n}\n')),Object(r.b)("br",null),Object(r.b)("h1",{id:"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e-fallback"},"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e fallback"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"},Object(r.b)("inlineCode",{parentName:"p"},"@SentinelResource")," \u52a0\u4e0a ",Object(r.b)("inlineCode",{parentName:"p"},"fallback")," \u5c5e\u6027"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"fallback")," \u5c5e\u6027\u6307\u5b9a\u4e00\u4e2a\u515c\u5e95\u65b9\u6cd5")),Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RequestMapping("/consumer/fallback/{id}")\n//    @SentinelResource(value = "fallback")\n@SentinelResource(value = "fallback", fallback = "handlerFallback")\n// \u5f02\u5e38\u5ffd\u7565 exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38\n// @SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler")\npublic CommonResult<Payment> fallback(@PathVariable Long id) {\n    CommonResult<Payment> result = restTemplate.getForObject(SERVICE_URL + "/paymentSQL/" + id, CommonResult.class, id);\n\n    if (id == 4) {\n        throw new IllegalArgumentException("IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...");\n    } else if (result.getData() == null) {\n        throw new NullPointerException("NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38");\n    }\n\n    return result;\n}\n\n// \u515c\u5e95\u65b9\u6cd5\npublic CommonResult handlerFallback(@PathVariable Long id, Throwable e) {\n    Payment payment = new Payment(id, "null");\n    return new CommonResult(444, "\u5f02\u5e38handlerFallback\uff0cexception\u5185\u5bb9\uff1a " + e.getMessage(), payment);\n}\n')),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u8bbf\u95ee ",Object(r.b)("inlineCode",{parentName:"li"},"http://localhost:84/consumer/fallback/4"),"\uff0c\u89e6\u53d1\u4e86\u515c\u5e95\u65b9\u6cd5\uff0c\u6253\u5370\u4e86\u81ea\u5b9a\u4e49\u5f02\u5e38\u4fe1\u606f\uff0c\u5c4f\u853d\u4e86 500 \u9519\u8bef\u53ca\u5f02\u5e38\u4fe1\u606f\u6808"),Object(r.b)("li",{parentName:"ul"},"\u8bbf\u95ee ",Object(r.b)("inlineCode",{parentName:"li"},"http://localhost:84/consumer/fallback/5"),"\uff0c\u89e6\u53d1\u4e86\u515c\u5e95\u65b9\u6cd5\uff0c\u6253\u5370\u4e86\u81ea\u5b9a\u4e49\u5f02\u5e38\u4fe1\u606f\uff0c\u5c4f\u853d\u4e86 500 \u9519\u8bef\u53ca\u5f02\u5e38\u4fe1\u606f\u6808")),Object(r.b)(c.a,{defaultValue:"1",values:[{label:"id 4 \u515c\u5e95\u54cd\u5e94",value:"1"},{label:"id 5 \u515c\u5e95\u54cd\u5e94",value:"2"}],mdxType:"Tabs"},Object(r.b)(o.a,{value:"1",mdxType:"TabItem"},Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-json"}),'{\n    "code": 444,\n    "message": "\u5f02\u5e38handlerFallback\uff0cexception\u5185\u5bb9\uff1a IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...",\n    "data": {\n        "id": 4,\n        "serial": "null"\n    }\n}\n'))),Object(r.b)(o.a,{value:"2",mdxType:"TabItem"},Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-json"}),'{\n    "code": 444,\n    "message": "\u5f02\u5e38handlerFallback\uff0cexception\u5185\u5bb9\uff1a NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38",\n    "data": {\n        "id": 5,\n        "serial": "null"\n    }\n}\n'))))),Object(r.b)("br",null),Object(r.b)("h1",{id:"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e-blockhandler"},"\u670d\u52a1\u7194\u65ad\u53ea\u914d\u7f6e blockHandler"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RequestMapping("/consumer/fallback/{id}")\n//    @SentinelResource(value = "fallback")\n//    @SentinelResource(value = "fallback", fallback = "handlerFallback")\n// \u5f02\u5e38\u5ffd\u7565 exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38\n@SentinelResource(value = "fallback", blockHandler = "blockHandler")\n// @SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler")\npublic CommonResult<Payment> fallback(@PathVariable Long id) {\n  CommonResult<Payment> result = restTemplate.getForObject(SERVICE_URL + "/paymentSQL/" + id, CommonResult.class, id);\n\n    if (id == 4) {\n        throw new IllegalArgumentException("IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...");\n    } else if (result.getData() == null) {\n        throw new NullPointerException("NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38");\n    }\n  \n    return result;\n}\n\npublic CommonResult blockHandler(@PathVariable Long id, BlockException e) {\n    Payment payment = new Payment(id, "null");\n    return new CommonResult(444, "blockHandler-sentinel \u9650\u6d41\uff0cBlockException\uff1a " + e.getMessage(), payment);\n}\n')),Object(r.b)("blockquote",null,Object(r.b)("h2",Object(t.a)({parentName:"blockquote"},{id:"\u6dfb\u52a0-sentinel-\u914d\u7f6e"}),"\u6dfb\u52a0 Sentinel \u914d\u7f6e"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u7ed9\u8d44\u6e90\u540d ",Object(r.b)("inlineCode",{parentName:"li"},"fallback")," \u6dfb\u52a0\u964d\u7ea7\u89c4\u5219")),Object(r.b)("br",null),Object(r.b)("img",{src:a(596).default,style:{zoom:"40%",boxShadow:"5px 7px 28px #333333",borderRadius:"19px"}}),Object(r.b)("h2",Object(t.a)({parentName:"blockquote"},{id:"\u6d4b\u8bd5"}),"\u6d4b\u8bd5"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u8bbf\u95ee ",Object(r.b)("inlineCode",{parentName:"li"},"http://localhost:84/consumer/fallback/4")),Object(r.b)("li",{parentName:"ul"},"Java \u5f02\u5e38\u4f1a\u76f4\u63a5\u4ee5 500 \u62a5\u6587\u54cd\u5e94"),Object(r.b)("li",{parentName:"ul"},"\u75af\u72c2\u8bbf\u95ee\uff0c\u89e6\u53d1\u964d\u7ea7\uff0c\u5f97\u5230 ",Object(r.b)("inlineCode",{parentName:"li"},"blockHandler")," \u65b9\u6cd5\u6267\u884c\u540e\u7684\u54cd\u5e94\u7ed3\u679c"))),Object(r.b)("br",null),Object(r.b)("h1",{id:"\u670d\u52a1\u7194\u65ad\u4e24\u4e2a\u90fd\u914d"},"\u670d\u52a1\u7194\u65ad\u4e24\u4e2a\u90fd\u914d"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RequestMapping("/consumer/fallback/{id}")\n//    @SentinelResource(value = "fallback")\n//    @SentinelResource(value = "fallback", fallback = "handlerFallback")\n// \u5f02\u5e38\u5ffd\u7565 exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38\n//    @SentinelResource(value = "fallback", blockHandler = "blockHandler")\n@SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler")\npublic CommonResult<Payment> fallback(@PathVariable Long id) {\n    CommonResult<Payment> result = restTemplate.getForObject(SERVICE_URL + "/paymentSQL/" + id, CommonResult.class, id);\n\n    if (id == 4) {\n        throw new IllegalArgumentException("IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...");\n    } else if (result.getData() == null) {\n        throw new NullPointerException("NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38");\n    }\n\n    return result;\n}\n\n\npublic CommonResult handlerFallback(@PathVariable Long id, Throwable e) {\n    Payment payment = new Payment(id, "null");\n    return new CommonResult(444, "\u5f02\u5e38handlerFallback\uff0cexception\u5185\u5bb9\uff1a " + e.getMessage(), payment);\n}\n\n\npublic CommonResult blockHandler(@PathVariable Long id, BlockException e) {\n    Payment payment = new Payment(id, "null");\n    return new CommonResult(444, "blockHandler-sentinel \u9650\u6d41\uff0cBlockException\uff1a " + e.getMessage(), payment);\n}\n')),Object(r.b)("blockquote",null,Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Java")," \u7684\u9519\u8bef\u4f1a\u89e6\u53d1 ",Object(r.b)("inlineCode",{parentName:"li"},"fallback")),Object(r.b)("li",{parentName:"ul"},"\u8fdd\u53cd Sentinel \u8bbe\u7f6e\u4f1a\u89e6\u53d1 ",Object(r.b)("inlineCode",{parentName:"li"},"blockHandler"))),Object(r.b)("h2",Object(t.a)({parentName:"blockquote"},{id:"\u5982\u679c\u4e00\u4e2a\u8bf7\u6c42\u628a\u4e24\u4e2a\u90fd\u89e6\u53d1\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f"}),"\u5982\u679c\u4e00\u4e2a\u8bf7\u6c42\u628a\u4e24\u4e2a\u90fd\u89e6\u53d1\u4e86\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("strong",{parentName:"li"},"\u6267\u884c\u7684\u662f ",Object(r.b)("inlineCode",{parentName:"strong"},"blockHandler")),"\uff0c\u56e0\u4e3a Sentinel \u7684\u9650\u6d41\u76f4\u63a5\u963b\u6b62\u4e86\u65b9\u6cd5\u7684\u6267\u884c\uff0c\u6839\u672c\u6267\u884c\u4e0d\u5230 ",Object(r.b)("inlineCode",{parentName:"li"},"fallback")))),Object(r.b)("br",null),Object(r.b)("h1",{id:"\u5f02\u5e38\u5ffd\u7565"},"\u5f02\u5e38\u5ffd\u7565"),Object(r.b)("p",null,"\u4f7f\u7528\uff1a",Object(r.b)("inlineCode",{parentName:"p"},"exceptionsToTrace")," \u5c5e\u6027\u6307\u5b9a\u8981\u5ffd\u7565\u7684\u5f02\u5e38\u7c7b\u578b"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38"))),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@RequestMapping("/consumer/fallback/{id}")\n//    @SentinelResource(value = "fallback")\n//    @SentinelResource(value = "fallback", fallback = "handlerFallback")\n// \u5f02\u5e38\u5ffd\u7565 exceptionsToTrace = IllegalArgumentException.class \u5ffd\u7565\u6307\u5b9a\u7684\u5f02\u5e38\n//    @SentinelResource(value = "fallback", blockHandler = "blockHandler")\n//    @SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler")\n@SentinelResource(value = "fallback", fallback = "handlerFallback", blockHandler = "blockHandler",exceptionsToIgnore = IllegalArgumentException.class)\npublic CommonResult<Payment> fallback(@PathVariable Long id) {\n    CommonResult<Payment> result = restTemplate.getForObject(SERVICE_URL + "/paymentSQL/" + id, CommonResult.class, id);\n\n    if (id == 4) {\n        throw new IllegalArgumentException("IllegalArgument ,\u975e\u6cd5\u53c2\u6570\u5f02\u5e38...");\n    } else if (result.getData() == null) {\n        throw new NullPointerException("NullPointerException,\u8be5ID\u6ca1\u6709\u5bf9\u5e94\u8bb0\u5f55\uff0c\u7a7a\u6307\u9488\u5f02\u5e38");\n    }\n\n    return result;\n}\n\n\npublic CommonResult handlerFallback(@PathVariable Long id, Throwable e) {\n    Payment payment = new Payment(id, "null");\n    return new CommonResult(444, "\u5f02\u5e38handlerFallback\uff0cexception\u5185\u5bb9\uff1a " + e.getMessage(), payment);\n}\n\n\npublic CommonResult blockHandler(@PathVariable Long id, BlockException e) {\n    Payment payment = new Payment(id, "null");\n    return new CommonResult(444, "blockHandler-sentinel \u9650\u6d41\uff0cBlockException\uff1a " + e.getMessage(), payment);\n}\n')),Object(r.b)("br",null),Object(r.b)("h1",{id:"\u6574\u5408-openfeign"},"\u6574\u5408 OpenFeign"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\u4fee\u6539 ",Object(r.b)("inlineCode",{parentName:"li"},"order84"))),Object(r.b)(c.a,{defaultValue:"1",values:[{label:"POM",value:"1"},{label:"YAML",value:"2"},{label:"\u4e3b\u542f\u52a8",value:"3"},{label:"\u4e1a\u52a1\u7c7b",value:"4"}],mdxType:"Tabs"},Object(r.b)(o.a,{value:"1",mdxType:"TabItem"},Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\u5f15\u5165 OpenFeign \uff0c\u4e4b\u524d\u5f15\u5165\u8fc7\u4e86")),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-xml"}),"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-openfeign</artifactId>\n</dependency>\n"))),Object(r.b)(o.a,{value:"2",mdxType:"TabItem"},Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\u8bbe\u7f6e\u6fc0\u6d3b OpenFeign")),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-yaml"}),"server:\n  port: 84\n\nspring:\n  application:\n    name: nacos-order-consumer\n  cloud:\n    nacos:\n      discovery:\n        server-addr: localhost:8848\n    sentinel:\n      transport:\n        dashboard: localhost:8080\n        port: 8719\n\n#\u6d88\u8d39\u8005\u5c06\u53bb\u8bbf\u95ee\u7684\u5fae\u670d\u52a1\u540d\u79f0\nserver-url:\n  nacos-user-service: http://nacos-payment-provider\n\n#\u6fc0\u6d3bSentinel\u5bf9Feign\u7684\u652f\u6301\nfeign:\n  sentinel:\n    enabled: true\n"))),Object(r.b)(o.a,{value:"3",mdxType:"TabItem"},Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\u4e3b\u542f\u52a8\u6dfb\u52a0 ",Object(r.b)("inlineCode",{parentName:"li"},"@EnableFeignClients")," \u6ce8\u89e3")),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),"@SpringBootApplication\n@EnableDiscoveryClient\n@EnableFeignClients\npublic class SentinelOrderMain84 {\n\n    public static void main(String[] args) {\n        SpringApplication.run(SentinelOrderMain84.class,args);\n    }\n}\n"))),Object(r.b)(o.a,{value:"4",mdxType:"TabItem"},Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u5f02\u5e38\u515c\u5e95\u7c7b")),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@Component\npublic class PaymentFallbackService implements PaymentFeignService {\n\n    @Override // \u6307\u5b9a paymentSQL \u65b9\u6cd5\u5931\u8d25\u540e\u7684\u5904\u7406\u4ee3\u7801\n    public CommonResult<Payment> paymentSQL(Long id) {\n        return new CommonResult<>(444,\n                "\u670d\u52a1\u964d\u7ea7\u8fd4\u56de\uff0c---PaymentFallbackService",\n                new Payment(id, "ErrorSerial"));\n    }\n}\n')),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Feign \u8c03\u7528\u63a5\u53e3",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"fallback")," \u5c5e\u6027\u6307\u5b9a\u81ea\u5b9a\u4e49\u5f02\u5e38\u5904\u7406\u7c7b")))),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java"}),'@FeignClient(value = "nacos-payment-provider", fallback = PaymentFallbackService.class)\npublic interface PaymentFeignService {\n\n    @GetMapping(value = "/paymentSQL/{id}")\n    public CommonResult<Payment> paymentSQL(@PathVariable("id") Long id);\n}\n')),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Controller \u901a\u8fc7\u8c03\u7528 Feign \u63a5\u53e3\u65b9\u6cd5")),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-java",metastring:'title="CircleBreakerController"',title:'"CircleBreakerController"'}),'//======= OpenFeign\n@Resource\nprivate PaymentFeignService paymentService;\n\n@GetMapping(value = "/consumer/paymentSQL/{id}")\npublic CommonResult<Payment> paymentSQL(@PathVariable("id") Long id) {\n    return paymentService.paymentSQL(id);\n}\n')))),Object(r.b)("blockquote",null,Object(r.b)("h2",Object(t.a)({parentName:"blockquote"},{id:"\u6d4b\u8bd5-1"}),"\u6d4b\u8bd5"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u53ea\u542f\u52a8 ",Object(r.b)("inlineCode",{parentName:"li"},"9003")),Object(r.b)("li",{parentName:"ul"},"\u91cd\u542f ",Object(r.b)("inlineCode",{parentName:"li"},"84")),Object(r.b)("li",{parentName:"ul"},"\u8bbf\u95ee ",Object(r.b)("inlineCode",{parentName:"li"},"http://localhost:84/consumer/paymentSQL/1"),"\uff0c\u53ef\u4ee5\u5f97\u5230\u6b63\u5e38\u54cd\u5e94\uff0c\u6765\u81ea ",Object(r.b)("inlineCode",{parentName:"li"},"9003"))),Object(r.b)("h2",Object(t.a)({parentName:"blockquote"},{id:"\u6d4b\u8bd5\u670d\u52a1\u964d\u7ea7"}),"\u6d4b\u8bd5\u670d\u52a1\u964d\u7ea7"),Object(r.b)("ul",{parentName:"blockquote"},Object(r.b)("li",{parentName:"ul"},"\u628a ",Object(r.b)("inlineCode",{parentName:"li"},"9003")," \u5173\u4e86\uff0c\u7ee7\u7eed\u8bbf\u95ee\uff0c\u5f53\u8c03\u7528\u5230 ",Object(r.b)("inlineCode",{parentName:"li"},"9003")," \u65f6\uff0c\u56e0\u4e3a ",Object(r.b)("inlineCode",{parentName:"li"},"9003")," \u6302\u4e86\uff0cOpenFeign \u7684\u8c03\u7528\u5c31\u4f1a\u51fa\u95ee\u9898"),Object(r.b)("li",{parentName:"ul"},"\u5e94\u5f53\u89e6\u53d1\u5b9a\u4e49\u7684\u81ea\u5b9a\u4e49\u515c\u5e95\u7c7b")),Object(r.b)("pre",{parentName:"blockquote"},Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-json"}),'{\n    "code": 444,\n    "message": "\u670d\u52a1\u964d\u7ea7\u8fd4\u56de\uff0c---PaymentFallbackService",\n    "data": {\n        "id": 1,\n        "serial": "ErrorSerial"\n    }\n}\n'))))}d.isMDXComponent=!0}}]);